<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Aug 28, 2012
 | Rendered using Apache Maven Fluido Skin 1.2.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>nano-project :: h-ubu</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

          
                
        <?xml version="1.0" encoding="UTF-8"?>
<link rel="stylesheet" type="text/css" href="./css/site.css"/>
      
                
        <?xml version="1.0" encoding="UTF-8"?>
<link rel="stylesheet" type="text/css" href="./css/font-awesome.css"/>
      
                
        <?xml version="1.0" encoding="UTF-8"?>
<script type="text/javascript">var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-1518442-11']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();</script>
      
                
        <?xml version="1.0" encoding="UTF-8"?>
<link rel="shortcut icon" href="favicon.png"/>
          
    <meta name="Date-Revision-yyyymmdd" content="20120828" />
    <meta http-equiv="Content-Language" content="en" />
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/nano-project/h-ubu">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 100;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="#" id="bannerLeft">
                                                                                                <img src="h-ubu-small.png"  alt="h-ubu - JavaScript Componentization"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2012-08-28</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 0.0.1-SNAPSHOT</li>
                      
                
            
      
                            </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
            
                                    <h3>H-UBU</h3>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Home">Home</a>
            </li>
                  <li class="none">
                          <a href="motivations.html" title="Motivations and Concepts">Motivations and Concepts</a>
            </li>
                  <li class="none">
                          <a href="quickstart.html" title="Quickstart">Quickstart</a>
            </li>
          </ul>
                        <h3>User Guide</h3>
                  <ul>
                  <li class="none">
                          <a href="creating-and-registering-components.html" title="Creating and Registering Components">Creating and Registering Components</a>
            </li>
                  <li class="none">
            <strong>Providing Services</strong>
          </li>
                  <li class="none">
                          <a href="requiring-services.html" title="Requiring Services">Requiring Services</a>
            </li>
                  <li class="none">
                          <a href="direct-injection.html" title="Direct Injection">Direct Injection</a>
            </li>
                  <li class="none">
                          <a href="receiving-and-sending-events.html" title="Receiving and Sending Events">Receiving and Sending Events</a>
            </li>
                  <li class="none">
                          <a href="testing-components.html" title="Testing Components">Testing Components</a>
            </li>
          </ul>
                        <h3>Advanced Topics</h3>
                  <ul>
                  <li class="none">
                          <a href="using-requirejs.html" title="Using require.js">Using require.js</a>
            </li>
                  <li class="none">
                          <a href="using-nodejs.html" title="Using h-ubu in node.js">Using h-ubu in node.js</a>
            </li>
                  <li class="none">
                          <a href="contract.html" title="Contract and Conformity">Contract and Conformity</a>
            </li>
                  <li class="none">
                          <a href="service-orientation.html" title="Service-Orientation">Service-Orientation</a>
            </li>
                  <li class="none">
                          <a href="developper-guide.html" title="Developer Guide">Developer Guide</a>
            </li>
          </ul>
                        <h3>Project Documentation</h3>
                  <ul>
                                                                                                                                                                                                                                                                          <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                      <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                      
            
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="http://nano-project.github.com/h-ubu" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="https://github.com/nano-project/h-ubu" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Providing Services</h1>

<p>Services are functionalities provided by one component to other components. Services promote loose-coupling as the
component consuming the service does not need to know anything about the provider. Moreover, services are dynamic,
so may be registered and unregistered at any time. This might look odd, but it can be really useful for modeling
disruptions (connectivity, context changes, etc.).</p>

<p>Before publishing a service, the component <strong>must</strong> implement the service's contract. So, let's imagine the following contract:</p>

<pre><code>var myContract = {
    doSomething: function() {}
};
</code></pre>

<p>The component providing this service must contain the <code>doSomething()</code> method.</p>

<p>To register the service, the component just has to call <code>provideService</code> within the <code>configure</code> method:</p>

<pre><code>var component = {
    configure: function(hub, configuration) {
        this.hub = hub;
        this.hub.provideService({
            component: this,
            contract : myContract
        });
    }
    // ...
}
</code></pre>

<p>Although registration can happen at any time, we recommend doing it within the <code>configure</code> method. The service will then
be published as soon as the hub starts.</p>

<p>The  <code>provideService</code> function takes an object as parameter. This object <strong>must</strong> contain the <code>component</code> key set to the
component object providing the service, and the <code>contract</code> key indicating the published contract.</p>

<p>A component can of course publish several services.</p>

<h1>Publishing Service Properties</h1>

<p>Service properties can provide some information about the service to the service consumer. The component can add
properties to the default service properties (<code>service.id</code>, <code>service.provider</code> and <code>service.contract</code>) . To publish
other service properties, you need to add the <code>properties</code> key to the object given to the <code>provideService</code> method:</p>

<pre><code>var component = {
    configure: function(hub, configuration) {
        this.hub = hub;
        this.hub.provideService({
            component: this,
            contract : myContract,
            properties: {
                myProperty : "myValue"
            }
        });
    }
    // ...
}
</code></pre>

<p>Those properties can help the service consumer to source the <code>best</code> service.</p>

<h1>Post/Pre Registration and Unregistration callback</h1>

<p>Your component can be notified when the service registered and unregistered. The <code>provideService</code> supports 4 callbacks:</p>

<ul>
<li><code>preRegistration</code>: method called before the registration.</li>
<li><code>postRegistration</code>: method called after the registration. It receives the <code>ServiceRegistration</code> as argument.</li>
<li><code>preUnregistration</code>: method called before unregistration. It receives the <code>ServiceRegistration</code> as argument.</li>
<li><code>postUnregistration</code>: method call after unregistration.</li>
</ul>

<p>Each value can be configured using a function pointer or the name of the function (called on the component object).</p>

<pre><code> var component = {
    configure: function(hub, configuration) {
        this.hub = hub;
        this.hub.provideService({
            component: this,
            contract : myContract,
            preRegistration: this.preRegistrationCallback,
            postRegistration: this.postRegistrationCallback,
            preUnregistration: this.preUnregistrationCallback,
            postUnregistration: "postUnregistrationCallback"
        });
    },

    preRegistrationCallback: function() { },
    postRegistrationCallback: function(reg) { },
    preUnregistrationCallback: function() { },
    postUnregistrationCallback: function(reg) { },

    // ...
}
</code></pre>

<h1>Modifying service properties</h1>

<p>You can modify the service properties dynamically. However, you need to retrieve the <code>ServiceRegistration</code> object
from the <code>postRegistrationCallback</code> first. Then, just call <code>setProperties(newProps)</code> on the service registration.</p>

<p>var component = {
        configure: function(hub, configuration) {
            this.hub = hub;
            this.hub.provideService({
                component: this,
                contract : myContract,
                postRegistration: this.postRegistrationCallback,
            });
        },</p>

<pre><code>    postRegistrationCallback: function(reg) {
        this.reg = reg;
        this.reg.setProperties({
            myProp : "my new value"
        }) ;
      },

    // ...
}
</code></pre>

<h1>Published Services and Service Dependencies</h1>

<p>The service dependencies of a component can impact the service publication. Indeed, as soon as a dependency of a service
is not resolved, the service is unpublished, and won't be published again until all service dependencies are resolved.</p>

<p>To avoid this behavior, set the service dependency as <em>optional</em>.</p>

                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2010-2012
                        <a href="http://www.arrow-group.eu/">Arrow-Group</a>.
            All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
